<p>&lt;!DOCTYPE html&gt;</p>
<html>
<head>
  <title>Rugby Players Data Table</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      text-align: left;
      padding: 8px;
    }

    th {
      cursor: pointer;
    }

    input[type="text"] {
      padding: 5px;
      width: 200px;
    }
  </style>
</head>
<body>
  <h1>Rugby Players Data Table</h1>

  <input type="text" id="searchInput" placeholder="Search for a player..." />

  <table id="playerTable">
    <thead>
      <tr>
        <th onclick="sortTable(0)">Name</th>
        <th onclick="sortTable(1)">Position</th>
        <th onclick="sortTable(2)">Nationality</th>
        <th onclick="sortTable(3)">Club</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <script>
    let players = [];

    async function fetchPlayers() {
      try {
        const response = await fetch('https://api.rugbyplayers.com/v1/players');
        const data = await response.json();
        players = data;
        displayPlayers(players);
      } catch (error) {
        console.error(error);
      }
    }

    function displayPlayers(players) {
      const tableBody = document.getElementById('tableBody');
      tableBody.innerHTML = '';

      for (let i = 0; i < players.length; i++) {
        const player = players[i];
        const row = createTableRow(player);
        tableBody.appendChild(row);
      }
    }

    function createTableRow(player) {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${player.name}</td>
        <td>${player.position}</td>
        <td>${player.nationality}</td>
        <td>${player.club}</td>
      `;
      return row;
    }

    function sortTable(columnIndex) {
      const table = document.getElementById('playerTable');
      const rows = Array.from(table.rows);
      const shouldSortAsText = [0, 1, 3].includes(columnIndex);

      rows.sort((rowA, rowB) => {
        const cellA = rowA.cells[columnIndex].textContent.trim();
        const cellB = rowB.cells[columnIndex].textContent.trim();

        if (shouldSortAsText) {
          return cellA.localeCompare(cellB);
        } else {
          return parseInt(cellA) - parseInt(cellB);
        }
      });

      // Reattach the sorted rows to the table
      for (let i = 0; i < rows.length; i++) {
        table.appendChild(rows[i]);
      }
    }

    document.getElementById('searchInput').addEventListener('input', function() {
      const query = this.value.trim().toLowerCase();
      const filteredPlayers = players.filter(player =>
        player.name.toLowerCase().includes(query)
      );

      displayPlayers(filteredPlayers);
    });

    fetchPlayers();
  </script>
</body>
</html>
