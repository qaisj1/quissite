layout: base
---
<!DOCTYPE html>
<html>
<head>
  <title>Country Data Table</title>
  <style>
    /* Styling for the table */
    table {
      border-collapse: collapse;
      width: 100%;
    }

    /* Styling for table cells */
    th, td {
      text-align: left;
      padding: 8px;
    }

    /* Cursor style for clickable headers */
    th {
      cursor: pointer;
    }

    /* Styling for the search input field */
    input[type="text"] {
      padding: 5px;
      width: 200px;
    }
  </style>
</head>
<body>
  <h1>Country Data Table</h1>

  <!-- Search input field -->
  <input type="text" id="searchInput" placeholder="Search for a country...">

  <!-- Country data table -->
  <table id="countryTable">
    <thead>
      <!-- Table header with clickable column names -->
      <tr>
        <th onclick="sortTable(0)">Name</th>
        <th onclick="sortTable(1)">Population</th>
        <th onclick="sortTable(2)">Area (sq. km)</th>
        <th onclick="sortTable(3)">Capital</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <script>
    let countries = [];

    // Fetch country data from REST Countries API
    fetch('https://restcountries.com/v3/all')
      .then(response => response.json())  // Convert the response to JSON
      .then(data => {
        countries = data;  // Store the fetched country data
        displayCountries(countries);  // Display the countries in the table
      })
      .catch(error => console.error(error));  // Log any errors that occur during the fetch

    function displayCountries(countries) {
      const tableBody = document.getElementById('tableBody');
      tableBody.innerHTML = '';  // Clear the table body

      // Loop through each country and create table rows
      for (let i = 0; i < countries.length; i++) {
        const country = countries[i];

        // Create a table row and populate it with country data
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${country.name.common}</td>
          <td>${country.population}</td>
          <td>${country.area || 'N/A'}</td>
          <td>${country.capital || 'N/A'}</td>
        `;

        tableBody.appendChild(row);  // Add the row to the table body
      }
    }

    // Function to sort the table based on the selected column
    function sortTable(columnIndex) {
      const table = document.getElementById('countryTable');
      const rows = Array.from(table.rows);
      const shouldSortAsNumber = columnIndex === 1 || columnIndex === 2;

      rows.sort((rowA, rowB) => {
        const cellA = rowA.cells[columnIndex].textContent.trim();
        const cellB = rowB.cells[columnIndex].textContent.trim();

        if (shouldSortAsNumber) {
          return parseInt(cellA) - parseInt(cellB);  // Sort numeric values
        } else {
          return cellA.localeCompare(cellB);  // Sort string values
        }
      });

      // Reattach the sorted rows to the table
      for (let i = 0; i < rows.length; i++) {
        table.appendChild(rows[i]);
      }
    }

    // Add event listener to the search input field
    document.getElementById('searchInput').addEventListener('input', function() {
      const query = this.value.trim().toLowerCase();
      const filteredCountries = countries.filter(country =>
        country.name.common.toLowerCase().includes(query)  // Filter countries based on the search query
      );

      displayCountries(filteredCountries);  // Display the filtered countries in the table
    });
  </script>
</body>
</html>
